{"version":3,"file":"index.js","sources":["../dist/index.js"],"sourcesContent":["class Leaf {\n    constructor(trie) {\n        this.children = [];\n        this.parent = trie;\n    }\n    delete(value) {\n        const index = this.children.indexOf(value);\n        if (index === -1)\n            return false;\n        this.children = this.children.slice(0, index).concat(this.children.slice(index + 1));\n        if (this.children.length === 0) {\n            this.parent.delete(this);\n        }\n        return true;\n    }\n    add(value) {\n        this.children.push(value);\n        return this;\n    }\n}\nclass RadixTrie {\n    constructor(trie) {\n        this.parent = null;\n        this.children = {};\n        this.parent = trie || null;\n    }\n    get(edge) {\n        return this.children[edge];\n    }\n    insert(edges) {\n        let currentNode = this;\n        for (let i = 0; i < edges.length; i += 1) {\n            const edge = edges[i];\n            let nextNode = currentNode.get(edge);\n            if (i === edges.length - 1) {\n                if (nextNode instanceof RadixTrie) {\n                    currentNode.delete(nextNode);\n                    nextNode = null;\n                }\n                if (!nextNode) {\n                    nextNode = new Leaf(currentNode);\n                    currentNode.children[edge] = nextNode;\n                }\n                return nextNode;\n            }\n            else {\n                if (nextNode instanceof Leaf)\n                    nextNode = null;\n                if (!nextNode) {\n                    nextNode = new RadixTrie(currentNode);\n                    currentNode.children[edge] = nextNode;\n                }\n            }\n            currentNode = nextNode;\n        }\n        return currentNode;\n    }\n    delete(node) {\n        for (const edge in this.children) {\n            const currentNode = this.children[edge];\n            if (currentNode === node) {\n                const success = delete this.children[edge];\n                if (Object.keys(this.children).length === 0 && this.parent) {\n                    this.parent.delete(this);\n                }\n                return success;\n            }\n        }\n        return false;\n    }\n}\n\nconst macosSymbolLayerKeys = {\n    ['¡']: '1',\n    ['™']: '2',\n    ['£']: '3',\n    ['¢']: '4',\n    ['∞']: '5',\n    ['§']: '6',\n    ['¶']: '7',\n    ['•']: '8',\n    ['ª']: '9',\n    ['º']: '0',\n    ['–']: '-',\n    ['≠']: '=',\n    ['⁄']: '!',\n    ['€']: '@',\n    ['‹']: '#',\n    ['›']: '$',\n    ['ﬁ']: '%',\n    ['ﬂ']: '^',\n    ['‡']: '&',\n    ['°']: '*',\n    ['·']: '(',\n    ['‚']: ')',\n    ['—']: '_',\n    ['±']: '+',\n    ['œ']: 'q',\n    ['∑']: 'w',\n    ['®']: 'r',\n    ['†']: 't',\n    ['¥']: 'y',\n    ['ø']: 'o',\n    ['π']: 'p',\n    ['“']: '[',\n    ['‘']: ']',\n    ['«']: '\\\\',\n    ['Œ']: 'Q',\n    ['„']: 'W',\n    ['´']: 'E',\n    ['‰']: 'R',\n    ['ˇ']: 'T',\n    ['Á']: 'Y',\n    ['¨']: 'U',\n    ['ˆ']: 'I',\n    ['Ø']: 'O',\n    ['∏']: 'P',\n    ['”']: '{',\n    ['’']: '}',\n    ['»']: '|',\n    ['å']: 'a',\n    ['ß']: 's',\n    ['∂']: 'd',\n    ['ƒ']: 'f',\n    ['©']: 'g',\n    ['˙']: 'h',\n    ['∆']: 'j',\n    ['˚']: 'k',\n    ['¬']: 'l',\n    ['…']: ';',\n    ['æ']: \"'\",\n    ['Å']: 'A',\n    ['Í']: 'S',\n    ['Î']: 'D',\n    ['Ï']: 'F',\n    ['˝']: 'G',\n    ['Ó']: 'H',\n    ['Ô']: 'J',\n    ['']: 'K',\n    ['Ò']: 'L',\n    ['Ú']: ':',\n    ['Æ']: '\"',\n    ['Ω']: 'z',\n    ['≈']: 'x',\n    ['ç']: 'c',\n    ['√']: 'v',\n    ['∫']: 'b',\n    ['µ']: 'm',\n    ['≤']: ',',\n    ['≥']: '.',\n    ['÷']: '/',\n    ['¸']: 'Z',\n    ['˛']: 'X',\n    ['Ç']: 'C',\n    ['◊']: 'V',\n    ['ı']: 'B',\n    ['˜']: 'N',\n    ['Â']: 'M',\n    ['¯']: '<',\n    ['˘']: '>',\n    ['¿']: '?'\n};\n\nconst macosUppercaseLayerKeys = {\n    ['`']: '~',\n    ['1']: '!',\n    ['2']: '@',\n    ['3']: '#',\n    ['4']: '$',\n    ['5']: '%',\n    ['6']: '^',\n    ['7']: '&',\n    ['8']: '*',\n    ['9']: '(',\n    ['0']: ')',\n    ['-']: '_',\n    ['=']: '+',\n    ['[']: '{',\n    [']']: '}',\n    ['\\\\']: '|',\n    [';']: ':',\n    [\"'\"]: '\"',\n    [',']: '<',\n    ['.']: '>',\n    ['/']: '?',\n    ['q']: 'Q',\n    ['w']: 'W',\n    ['e']: 'E',\n    ['r']: 'R',\n    ['t']: 'T',\n    ['y']: 'Y',\n    ['u']: 'U',\n    ['i']: 'I',\n    ['o']: 'O',\n    ['p']: 'P',\n    ['a']: 'A',\n    ['s']: 'S',\n    ['d']: 'D',\n    ['f']: 'F',\n    ['g']: 'G',\n    ['h']: 'H',\n    ['j']: 'J',\n    ['k']: 'K',\n    ['l']: 'L',\n    ['z']: 'Z',\n    ['x']: 'X',\n    ['c']: 'C',\n    ['v']: 'V',\n    ['b']: 'B',\n    ['n']: 'N',\n    ['m']: 'M'\n};\n\nconst syntheticKeyNames = {\n    ' ': 'Space',\n    '+': 'Plus'\n};\nfunction eventToHotkeyString(event, platform = navigator.platform) {\n    var _a, _b, _c;\n    const { ctrlKey, altKey, metaKey, shiftKey, key } = event;\n    const hotkeyString = [];\n    const modifiers = [ctrlKey, altKey, metaKey, shiftKey];\n    for (const [i, mod] of modifiers.entries()) {\n        if (mod)\n            hotkeyString.push(modifierKeyNames[i]);\n    }\n    if (!modifierKeyNames.includes(key)) {\n        const altNormalizedKey = hotkeyString.includes('Alt') && matchApplePlatform.test(platform) ? (_a = macosSymbolLayerKeys[key]) !== null && _a !== void 0 ? _a : key : key;\n        const shiftNormalizedKey = hotkeyString.includes('Shift') && matchApplePlatform.test(platform)\n            ? (_b = macosUppercaseLayerKeys[altNormalizedKey]) !== null && _b !== void 0 ? _b : altNormalizedKey\n            : altNormalizedKey;\n        const syntheticKey = (_c = syntheticKeyNames[shiftNormalizedKey]) !== null && _c !== void 0 ? _c : shiftNormalizedKey;\n        hotkeyString.push(syntheticKey);\n    }\n    return hotkeyString.join('+');\n}\nconst modifierKeyNames = ['Control', 'Alt', 'Meta', 'Shift'];\nfunction normalizeHotkey(hotkey, platform) {\n    let result;\n    result = localizeMod(hotkey, platform);\n    result = sortModifiers(result);\n    return result;\n}\nconst matchApplePlatform = /Mac|iPod|iPhone|iPad/i;\nfunction localizeMod(hotkey, platform) {\n    var _a;\n    const ssrSafeWindow = typeof window === 'undefined' ? undefined : window;\n    const safePlatform = (_a = platform !== null && platform !== void 0 ? platform : ssrSafeWindow === null || ssrSafeWindow === void 0 ? void 0 : ssrSafeWindow.navigator.platform) !== null && _a !== void 0 ? _a : '';\n    const localModifier = matchApplePlatform.test(safePlatform) ? 'Meta' : 'Control';\n    return hotkey.replace('Mod', localModifier);\n}\nfunction sortModifiers(hotkey) {\n    const key = hotkey.split('+').pop();\n    const modifiers = [];\n    for (const modifier of ['Control', 'Alt', 'Meta', 'Shift']) {\n        if (hotkey.includes(modifier)) {\n            modifiers.push(modifier);\n        }\n    }\n    if (key)\n        modifiers.push(key);\n    return modifiers.join('+');\n}\n\nconst SEQUENCE_DELIMITER = ' ';\nclass SequenceTracker {\n    constructor({ onReset } = {}) {\n        this._path = [];\n        this.timer = null;\n        this.onReset = onReset;\n    }\n    get path() {\n        return this._path;\n    }\n    get sequence() {\n        return this._path.join(SEQUENCE_DELIMITER);\n    }\n    registerKeypress(event) {\n        this._path = [...this._path, eventToHotkeyString(event)];\n        this.startTimer();\n    }\n    reset() {\n        var _a;\n        this.killTimer();\n        this._path = [];\n        (_a = this.onReset) === null || _a === void 0 ? void 0 : _a.call(this);\n    }\n    killTimer() {\n        if (this.timer != null) {\n            window.clearTimeout(this.timer);\n        }\n        this.timer = null;\n    }\n    startTimer() {\n        this.killTimer();\n        this.timer = window.setTimeout(() => this.reset(), SequenceTracker.CHORD_TIMEOUT);\n    }\n}\nSequenceTracker.CHORD_TIMEOUT = 1500;\nfunction normalizeSequence(sequence) {\n    return sequence\n        .split(SEQUENCE_DELIMITER)\n        .map(h => normalizeHotkey(h))\n        .join(SEQUENCE_DELIMITER);\n}\n\nfunction isFormField(element) {\n    if (!(element instanceof HTMLElement)) {\n        return false;\n    }\n    const name = element.nodeName.toLowerCase();\n    const type = (element.getAttribute('type') || '').toLowerCase();\n    return (name === 'select' ||\n        name === 'textarea' ||\n        (name === 'input' &&\n            type !== 'submit' &&\n            type !== 'reset' &&\n            type !== 'checkbox' &&\n            type !== 'radio' &&\n            type !== 'file') ||\n        element.isContentEditable);\n}\nfunction fireDeterminedAction(el, path) {\n    const delegateEvent = new CustomEvent('hotkey-fire', { cancelable: true, detail: { path } });\n    const cancelled = !el.dispatchEvent(delegateEvent);\n    if (cancelled)\n        return;\n    if (isFormField(el)) {\n        el.focus();\n    }\n    else {\n        el.click();\n    }\n}\nfunction expandHotkeyToEdges(hotkey) {\n    const output = [];\n    let acc = [''];\n    let commaIsSeparator = false;\n    for (let i = 0; i < hotkey.length; i++) {\n        if (commaIsSeparator && hotkey[i] === ',') {\n            output.push(acc);\n            acc = [''];\n            commaIsSeparator = false;\n            continue;\n        }\n        if (hotkey[i] === SEQUENCE_DELIMITER) {\n            acc.push('');\n            commaIsSeparator = false;\n            continue;\n        }\n        else if (hotkey[i] === '+') {\n            commaIsSeparator = false;\n        }\n        else {\n            commaIsSeparator = true;\n        }\n        acc[acc.length - 1] += hotkey[i];\n    }\n    output.push(acc);\n    return output.map(h => h.map(k => normalizeHotkey(k)).filter(k => k !== '')).filter(h => h.length > 0);\n}\n\nconst hotkeyRadixTrie = new RadixTrie();\nconst elementsLeaves = new WeakMap();\nlet currentTriePosition = hotkeyRadixTrie;\nconst sequenceTracker = new SequenceTracker({\n    onReset() {\n        currentTriePosition = hotkeyRadixTrie;\n    }\n});\nfunction keyDownHandler(event) {\n    if (event.defaultPrevented)\n        return;\n    if (!(event.target instanceof Node))\n        return;\n    if (isFormField(event.target)) {\n        const target = event.target;\n        if (!target.id)\n            return;\n        if (!target.ownerDocument.querySelector(`[data-hotkey-scope=\"${target.id}\"]`))\n            return;\n    }\n    const newTriePosition = currentTriePosition.get(eventToHotkeyString(event));\n    if (!newTriePosition) {\n        sequenceTracker.reset();\n        return;\n    }\n    sequenceTracker.registerKeypress(event);\n    currentTriePosition = newTriePosition;\n    if (newTriePosition instanceof Leaf) {\n        const target = event.target;\n        let shouldFire = false;\n        let elementToFire;\n        const formField = isFormField(target);\n        for (let i = newTriePosition.children.length - 1; i >= 0; i -= 1) {\n            elementToFire = newTriePosition.children[i];\n            const scope = elementToFire.getAttribute('data-hotkey-scope');\n            if ((!formField && !scope) || (formField && target.id === scope)) {\n                shouldFire = true;\n                break;\n            }\n        }\n        if (elementToFire && shouldFire) {\n            fireDeterminedAction(elementToFire, sequenceTracker.path);\n            event.preventDefault();\n        }\n        sequenceTracker.reset();\n    }\n}\nfunction install(element, hotkey) {\n    if (Object.keys(hotkeyRadixTrie.children).length === 0) {\n        document.addEventListener('keydown', keyDownHandler);\n    }\n    const hotkeys = expandHotkeyToEdges(hotkey || element.getAttribute('data-hotkey') || '');\n    const leaves = hotkeys.map(h => hotkeyRadixTrie.insert(h).add(element));\n    elementsLeaves.set(element, leaves);\n}\nfunction uninstall(element) {\n    const leaves = elementsLeaves.get(element);\n    if (leaves && leaves.length) {\n        for (const leaf of leaves) {\n            leaf && leaf.delete(element);\n        }\n    }\n    if (Object.keys(hotkeyRadixTrie.children).length === 0) {\n        document.removeEventListener('keydown', keyDownHandler);\n    }\n}\n\nexport { Leaf, RadixTrie, SequenceTracker, eventToHotkeyString, install, normalizeHotkey, normalizeSequence, uninstall };\n"],"names":["Leaf","constructor","trie","this","children","parent","value","index","indexOf","slice","concat","length","delete","add","push","RadixTrie","get","edge","insert","edges","currentNode","i","nextNode","node","success","Object","keys","macosSymbolLayerKeys","macosUppercaseLayerKeys","q","w","e","r","t","y","u","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","syntheticKeyNames","eventToHotkeyString","event","platform","navigator","_a","_b","_c","ctrlKey","altKey","metaKey","shiftKey","key","hotkeyString","modifiers","mod","entries","modifierKeyNames","includes","altNormalizedKey","matchApplePlatform","test","shiftNormalizedKey","syntheticKey","join","normalizeHotkey","hotkey","result","localizeMod","sortModifiers","ssrSafeWindow","window","undefined","safePlatform","localModifier","replace","split","pop","modifier","SEQUENCE_DELIMITER","SequenceTracker","onReset","_path","timer","path","sequence","registerKeypress","startTimer","reset","killTimer","call","clearTimeout","setTimeout","CHORD_TIMEOUT","normalizeSequence","map","isFormField","element","HTMLElement","name","nodeName","toLowerCase","type","getAttribute","isContentEditable","fireDeterminedAction","el","delegateEvent","CustomEvent","cancelable","detail","cancelled","dispatchEvent","focus","click","expandHotkeyToEdges","output","acc","commaIsSeparator","filter","hotkeyRadixTrie","elementsLeaves","WeakMap","currentTriePosition","sequenceTracker","keyDownHandler","defaultPrevented","target","Node","id","ownerDocument","querySelector","newTriePosition","shouldFire","elementToFire","formField","scope","preventDefault","install","document","addEventListener","hotkeys","leaves","set","uninstall","leaf","removeEventListener"],"mappings":"AAAA,MAAMA,KACF,WAAAC,CAAYC,GACRC,KAAKC,SAAW,GAChBD,KAAKE,OAASH,CACjB,CACD,OAAOI,GACH,MAAMC,EAAQJ,KAAKC,SAASI,QAAQF,GACpC,GAAIC,KAAW,EACX,OAAO,MACXJ,KAAKC,SAAWD,KAAKC,SAASK,MAAM,EAAGF,GAAOG,OAAOP,KAAKC,SAASK,MAAMF,EAAQ,IAC7EJ,KAAKC,SAASO,SAAW,GACzBR,KAAKE,OAAOO,OAAOT,MAEvB,OAAO,IACV,CACD,GAAAU,CAAIP,GACAH,KAAKC,SAASU,KAAKR,GACnB,OAAOH,IACV,EAEL,MAAMY,UACF,WAAAd,CAAYC,GACRC,KAAKE,OAAS,KACdF,KAAKC,SAAW,GAChBD,KAAKE,OAASH,GAAQ,IACzB,CACD,GAAAc,CAAIC,GACA,OAAOd,KAAKC,SAASa,EACxB,CACD,MAAAC,CAAOC,GACH,IAAIC,EAAcjB,KAClB,IAAK,IAAIkB,EAAI,EAAGA,EAAIF,EAAMR,OAAQU,GAAK,EAAG,CACtC,MAAMJ,EAAOE,EAAME,GACnB,IAAIC,EAAWF,EAAYJ,IAAIC,GAC/B,GAAII,IAAMF,EAAMR,OAAS,EAAG,CACxB,GAAIW,aAAoBP,UAAW,CAC/BK,EAAYR,OAAOU,GACnBA,EAAW,IACd,CACD,IAAKA,EAAU,CACXA,EAAW,IAAItB,KAAKoB,GACpBA,EAAYhB,SAASa,GAAQK,CAChC,CACD,OAAOA,CACV,CAEOA,aAAoBtB,OACpBsB,EAAW,MACf,IAAKA,EAAU,CACXA,EAAW,IAAIP,UAAUK,GACzBA,EAAYhB,SAASa,GAAQK,CAChC,CAELF,EAAcE,CACjB,CACD,OAAOF,CACV,CACD,OAAOG,GACH,IAAK,MAAMN,KAAQd,KAAKC,SAAU,CAC9B,MAAMgB,EAAcjB,KAAKC,SAASa,GAClC,GAAIG,IAAgBG,EAAM,CACtB,MAAMC,SAAiBrB,KAAKC,SAASa,GACjCQ,OAAOC,KAAKvB,KAAKC,UAAUO,SAAW,GAAKR,KAAKE,QAChDF,KAAKE,OAAOO,OAAOT,MAEvB,OAAOqB,CACV,CACJ,CACD,OAAO,KACV,EAGL,MAAMG,EAAuB,CACzB,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,KACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,KAGX,MAAMC,EAA0B,CAC5B,IAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,EAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,KAAQ,IACR,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACP,IAAO,IACPC,EAAO,IACPC,EAAO,IACPC,EAAO,IACPC,EAAO,IACPC,EAAO,IACPC,EAAO,IACPC,EAAO,IACPd,EAAO,I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"}